<div class="board-header">
  <h1>Board</h1>
  <div class="search-and-btn align-center">
    <input placeholder="Find Task" />
    <button (click)="openAddTaskDialog('To Do')" class="main-btn">
      Add task <img src="assets/img/plus.png" />
    </button>
  </div>
</div>

<div class="tasks-container">
  <div
    class="to-do width-250 cdkDropList"
    cdkDropList
    (cdkDropListDropped)="onTaskDrop($event, 'To Do')"
  >
    <h2 class="space-between font-21">
      To do
      <img
        (click)="openAddTaskDialog('To Do')"
        src="assets/img/plus-button-v1.png"
      />
    </h2>
    <mat-card
      (click)="openTaskDetails(task, 'To Do')"
      class="mb-12"
      *ngFor="let task of allTasksToDo$ | async"
    >
      <mat-card-header>
        <mat-card-subtitle
          [style.background-color]="task.categoryColor"
          class="category text-center font-16"
          >{{ task.category }}</mat-card-subtitle
        >
        <mat-card-title>{{ task.title }}</mat-card-title>
        <mat-card-subtitle class="description font-16">{{
          task.description
        }}</mat-card-subtitle>
      </mat-card-header>
      <div class="progress" *ngIf="task.subtasks.length">
        <mat-progress-bar
          [value]="(task.checkedSubtasks / task.subtasks.length) * 100"
        ></mat-progress-bar
        ><span>{{ task.checkedSubtasks || 0 }}/{{ task.subtasks.length }} Done</span>
      </div>
    </mat-card>
  </div>
  <div
    class="in-progress width-250"
    cdkDropList
    (cdkDropListDropped)="onTaskDrop($event, 'In Progress')"
  >
    <h2 class="space-between font-21">
      In progress
      <img
        (click)="openAddTaskDialog('In Progress')"
        src="assets/img/plus-button-v1.png"
      />
    </h2>
    <mat-card
      (click)="openTaskDetails(task, 'In Progress')"
      class="mb-12"
      *ngFor="let task of allTasksInProgress$ | async"
    >
      <mat-card-header>
        <mat-card-subtitle
          [style.background-color]="task.categoryColor"
          class="category text-center font-16"
          >{{ task.category }}</mat-card-subtitle
        >
        <mat-card-title>{{ task.title }}</mat-card-title>
        <mat-card-subtitle class="description font-16">{{
          task.description
        }}</mat-card-subtitle>
      </mat-card-header>
      <div class="progress" *ngIf="task.subtasks.length">
        <mat-progress-bar
          [value]="(task.checkedSubtasks / task.subtasks.length) * 100"
        ></mat-progress-bar
        ><span>{{ task.checkedSubtasks || 0 }}/{{ task.subtasks.length }} Done</span>
      </div>
    </mat-card>
  </div>
  <div
    class="awaiting-feedback width-250"
    cdkDropList
    (cdkDropListDropped)="onTaskDrop($event, 'Awaiting Feedback')"
  >
    <h2 class="space-between font-21">
      Awaiting Feedback
      <img
        (click)="openAddTaskDialog('Awaiting Feedback')"
        src="assets/img/plus-button-v1.png"
      />
    </h2>
    <mat-card
      (click)="openTaskDetails(task, 'Awaiting Feedback')"
      class="mb-12"
      *ngFor="let task of allTasksAwaitingFeedback$ | async"
    >
      <mat-card-header>
        <mat-card-subtitle
          [style.background-color]="task.categoryColor"
          class="category text-center font-16"
          >{{ task.category }}</mat-card-subtitle
        >
        <mat-card-title>{{ task.title }}</mat-card-title>
        <mat-card-subtitle class="description font-16">{{
          task.description
        }}</mat-card-subtitle>
      </mat-card-header>
      <div class="progress" *ngIf="task.subtasks.length">
        <mat-progress-bar
          [value]="(task.checkedSubtasks / task.subtasks.length) * 100"
        ></mat-progress-bar
        ><span>{{ task.checkedSubtasks || 0 }}/{{ task.subtasks.length }} Done</span>
      </div>
    </mat-card>
  </div>
  <div
    class="done width-250"
    cdkDropList
    (cdkDropListDropped)="onTaskDrop($event, 'Done')"
  >
    <h2 class="space-between font-21">
      Done
      <img
        (click)="openAddTaskDialog('Done')"
        src="assets/img/plus-button-v1.png"
      />
    </h2>
    <mat-card
      (click)="openTaskDetails(task, 'Done')"
      class="mb-12"
      *ngFor="let task of allTasksDone$ | async"
    >
      <mat-card-header>
        <mat-card-subtitle
          [style.background-color]="task.categoryColor"
          class="category text-center font-16"
          >{{ task.category }}</mat-card-subtitle
        >
        <mat-card-title>{{ task.title }}</mat-card-title>
        <mat-card-subtitle class="description font-16">{{
          task.description
        }}</mat-card-subtitle>
      </mat-card-header>
      <div class="progress" *ngIf="task.subtasks.length">
        <mat-progress-bar
          [value]="(task.checkedSubtasks / task.subtasks.length) * 100"
        ></mat-progress-bar
        ><span>{{ task.checkedSubtasks || 0 }}/{{ task.subtasks.length }} Done</span>
      </div>
    </mat-card>
  </div>
</div>
